module testStrings

import ../strings
import ../io

fn testStringBuiltin()
    data s1 string
    data s2 string
    let true = s1 == s2
    {s1, "abStr987!.<?\n"}.writeString()
    let false = s1 == s2
    {s2, "abStr987!.<?\n"}.writeString()
    let true = s1 == s2
    s1.push(' ')
    let false = s1 == s2
    s1.push('_')
    let false = s1 == s2


fn testFind()
    data s string "abunch,of.chars!?!\n"
    let i64(0) = s.find('a')
    let null = s.find('x')
    let i64(6) = s.find(',')
    let i64(18) = s.find('\n')
    let null = {s, ">"}.find()
    let i64(0) = {s, ""}.find()
    let null = {s, "abunch?"}.find()
    let i64(0) = {s, "abunch,"}.find()
    let null = {s, ",Of."}.find()
    let i64(6) = {s, ",of."}.find()
    let null = {s, "!?!?"}.find()
    let i64(15) = {s, "!?!\n"}.find()


fn testWrite()
    data s string
    s.writeChar('a')
    s.writeBool(false)
    s.writeI64(0)
    {s, ".str!"}.writeString()
    s.writeI64(-123)
    let true = s == "afalse0.str!-123"


fn testRead()
    data s string
    {s, "abc123!?.-945"}.writeString()
    //let 1 = s.read(0, 'a')
    let (123, 6) = s.read(3)
    let (0, 0) = s.read(6)
    s.clear()
    {s, "x   123!?.-945"}.writeString()
    let (123, 7) = s.read(1)


fn {io Io} testStrings()
    testStringBuiltin()
    testFind()
    testWrite()
    testRead()
    io.write("testStrings passed\n")
