module testSparse

import ../strings
import ../io


fn testSparsePush()
    data ints sparse[i64]
    let 0:@i64 = ints.push(4)
    let 1:@i64 = ints.push(5)
    let 2:@i64 = ints.push(6)
    let [4, 5, 6] = ints


fn testSparseDelete()
    data ints sparse[i64]
    let 0:@i64 = ints.push(4)
    let 1:@i64 = ints.push(5)
    let [4, 5] = ints
    ints.delete(0)
    let [0, 5] = ints
    let 0:@i64 = ints.push(6)
    let [6, 5] = ints 


fn testSparseWithStrings()
    data strings sparse[string]
    let 0 = strings.push()
    let 1 = strings.push()
    let 2 = strings.push()
    let ["", "", ""] = strings
    {strings[0], "test0"}.writeString()
    {strings[1], "t35t1"}.writeString()
    {strings[2], "test2"}.writeString()
    let ["test0", "t35t1", "test2"] = strings
    strings.delete(2)
    let ["test0", "t35t1"] = strings
    let 2 = strings.push()
    let ["test0", "t35t1", ""] = strings
    strings.delete(0)
    let ["", "t35t1", ""] = strings
    strings.delete(1)
    let ["", "", ""] = strings
    let 1 = strings.push()
    let 0 = strings.push()


fn {io Io} testSparse()
    testSparsePush()
    testSparseDelete()
    testSparseWithStrings()
    io.write("testSparse passed\n")
